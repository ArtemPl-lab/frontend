{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\User\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\learning\\\\vseotzivu\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"C:\\\\Users\\\\User\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\learning\\\\vseotzivu\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _objectSpread from\"C:\\\\Users\\\\User\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\learning\\\\vseotzivu\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:\\\\Users\\\\User\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\learning\\\\vseotzivu\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\User\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\learning\\\\vseotzivu\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{useDispatch,useSelector}from'react-redux';import{deleteCommentReply,notification}from'../../redux/actions';import{useAPI}from'../../hooks/api.hook';var CommentForm=function CommentForm(_ref){var post=_ref.post;var dispatch=useDispatch();var replay=useSelector(function(state){return state.comments.commentReply;});var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isValid=_useState2[0],setValid=_useState2[1];var _useAPI=useAPI(),request=_useAPI.request;var _useState3=useState({name:'',content:''}),_useState4=_slicedToArray(_useState3,2),formValues=_useState4[0],setFormValues=_useState4[1];var validation=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();setValid(true);if(!(event.target.checkValidity()===false)){_context.next=6;break;}event.stopPropagation();_context.next=14;break;case 6:dispatch(notification({isShow:true}));_context.next=9;return request('/api/posts/add/comment','POST',JSON.stringify(_objectSpread(_objectSpread({},formValues),{},{postId:post._id,replay:replay._id})));case 9:response=_context.sent;dispatch(notification({title:response.type===\"success\"?'Уведомление':'Ошибка',content:response.message}));setValid(false);setFormValues({name:'',content:''});dispatch(deleteCommentReply());case 14:case\"end\":return _context.stop();}}},_callee);}));return function validation(_x){return _ref2.apply(this,arguments);};}();var handleChange=function handleChange(event){setFormValues(function(formValues){return _objectSpread(_objectSpread({},formValues),{},_defineProperty({},event.target.name,event.target.value));});};var closeAlert=function closeAlert(event){event.preventDefault();dispatch(deleteCommentReply());};return/*#__PURE__*/React.createElement(\"div\",{className:\"card mt-4\",name:\"commentForm\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"card-header\"},\"\\u041E\\u0441\\u0442\\u0430\\u0432\\u0438\\u0442\\u044C \\u043A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\"),/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},replay&&/*#__PURE__*/React.createElement(\"div\",{className:\"alert alert-primary alert-dismissible fade show\",role:\"alert\"},/*#__PURE__*/React.createElement(\"strong\",null,\"\\u041E\\u0442\\u0432\\u0435\\u0442 \\u043D\\u0430 \\u043A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439: \"),\" \\\"\",replay.content.slice(0,20),\"...\\\"\",/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"close\",onClick:closeAlert},/*#__PURE__*/React.createElement(\"span\",null,\"\\xD7\"))),/*#__PURE__*/React.createElement(\"form\",{className:\"needs-validation \".concat(isValid?\"was-validated\":\"\"),noValidate:true,onSubmit:validation},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"name\"},\"\\u0412\\u0430\\u0448\\u0435 \\u0438\\u043C\\u044F\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"form-control\",id:\"name\",name:\"name\",required:true,onChange:handleChange,value:formValues.name}),/*#__PURE__*/React.createElement(\"small\",{id:\"emailHelp\",className:\"form-text text-muted\"},\"\\u0411\\u0443\\u0434\\u0435\\u0442 \\u043E\\u0442\\u043E\\u0431\\u0440\\u0430\\u0436\\u0430\\u0442\\u044C\\u0441\\u044F \\u0440\\u044F\\u0434\\u043E\\u043C \\u0441 \\u043A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0435\\u043C\")),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"content\"},\"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\"),/*#__PURE__*/React.createElement(\"textarea\",{className:\"form-control\",id:\"content\",name:\"content\",required:true,onChange:handleChange,value:formValues.content})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group mt-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-check\"},/*#__PURE__*/React.createElement(\"input\",{className:\"form-check-input\",type:\"checkbox\",value:\"\",id:\"invalidCheck\",required:true}),/*#__PURE__*/React.createElement(\"label\",{className:\"form-check-label\",htmlFor:\"invalidCheck\"},\"\\u042F \\u0441\\u043E\\u0433\\u043B\\u0430\\u0441\\u0435\\u043D \\u0441 \",/*#__PURE__*/React.createElement(\"a\",{href:\"/rules\"},\"\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u0430\\u043C\\u0438 \\u0441\\u0430\\u0439\\u0442\\u0430\")),/*#__PURE__*/React.createElement(\"div\",{className:\"invalid-feedback\"},\"\\u0412\\u044B \\u0434\\u043E\\u043B\\u0436\\u043D\\u044B \\u0441\\u043E\\u0433\\u043B\\u0430\\u0441\\u0438\\u0442\\u044C\\u0441\\u044F \\u0441 \\u0443\\u0441\\u043B\\u043E\\u0432\\u0438\\u044F\\u043C\\u0438, \\u0447\\u0442\\u043E\\u0431\\u044B \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u0444\\u043E\\u0440\\u043C\\u0443\"))),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary mt-2\"},\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"))));};export default CommentForm;","map":{"version":3,"sources":["C:/Users/User/OneDrive/Рабочий стол/learning/vseotzivu/frontend/src/components/PostPage/CommentForm.jsx"],"names":["React","useState","useDispatch","useSelector","deleteCommentReply","notification","useAPI","CommentForm","post","dispatch","replay","state","comments","commentReply","isValid","setValid","request","name","content","formValues","setFormValues","validation","event","preventDefault","target","checkValidity","stopPropagation","isShow","JSON","stringify","postId","_id","response","title","type","message","handleChange","value","closeAlert","slice"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { deleteCommentReply, notification } from '../../redux/actions';\r\nimport { useAPI } from '../../hooks/api.hook';\r\n\r\nconst CommentForm = ({ post }) => {\r\n    const dispatch = useDispatch();\r\n    const replay = useSelector(state => state.comments.commentReply);\r\n    const [isValid,setValid] = useState(false);\r\n    const { request } = useAPI();\r\n    const [formValues, setFormValues] = useState({\r\n        name: '',\r\n        content: ''\r\n    });\r\n    const validation = async (event) =>{\r\n        event.preventDefault();\r\n        setValid(true);\r\n        if (event.target.checkValidity() === false) event.stopPropagation();\r\n        else{\r\n            dispatch(notification({isShow: true}));\r\n            const response = await request('/api/posts/add/comment', 'POST', JSON.stringify({ ...formValues, postId: post._id, replay: replay._id}));\r\n            dispatch(notification({\r\n                title: response.type === \"success\" ? 'Уведомление' : 'Ошибка',\r\n                content: response.message\r\n            }));\r\n            setValid(false);\r\n            setFormValues({\r\n                name: '',\r\n                content: ''\r\n            });\r\n            dispatch(deleteCommentReply());\r\n        }\r\n    }\r\n    const handleChange = event => {\r\n        setFormValues(formValues => ({\r\n            ...formValues,\r\n            [event.target.name]: event.target.value\r\n        })); \r\n    }\r\n    const closeAlert = event => {\r\n        event.preventDefault();\r\n        dispatch(deleteCommentReply());\r\n    }\r\n    return (\r\n        <div className=\"card mt-4\" name=\"commentForm\">\r\n            <h5 className=\"card-header\">Оставить комментарий</h5>\r\n            <div className=\"card-body\">\r\n            {\r\n                replay && (\r\n                    <div className=\"alert alert-primary alert-dismissible fade show\" role=\"alert\">\r\n                        <strong>Ответ на комментарий: </strong> \"{replay.content.slice(0, 20)}...\"\r\n                        <button type=\"button\" className=\"close\" onClick={closeAlert}>\r\n                            <span>&times;</span>\r\n                        </button>\r\n                    </div>)\r\n            }\r\n            <form className={`needs-validation ${isValid ? \"was-validated\" : \"\"}`} noValidate onSubmit={validation}>\r\n                <div className=\"form-group\">\r\n                    <label htmlFor=\"name\">Ваше имя</label>\r\n                    <input type=\"text\" className=\"form-control\" id=\"name\" name=\"name\" required onChange={ handleChange } value={formValues.name}/>\r\n                    <small id=\"emailHelp\" className=\"form-text text-muted\">Будет отображаться рядом с комментарием</small>\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label htmlFor=\"content\">Комментарий</label>\r\n                    <textarea className=\"form-control\" id=\"content\" name=\"content\" required onChange={ handleChange } value={formValues.content}/>\r\n                </div>\r\n                <div className=\"form-group mt-2\">\r\n                    <div className=\"form-check\">\r\n                        <input className=\"form-check-input\" type=\"checkbox\" value=\"\" id=\"invalidCheck\" required />\r\n                        <label className=\"form-check-label\" htmlFor=\"invalidCheck\">\r\n                            Я согласен с <a href=\"/rules\">правилами сайта</a>\r\n                        </label>\r\n                        <div className=\"invalid-feedback\">\r\n                            Вы должны согласиться с условиями, чтобы отправить форму\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <button type=\"submit\" className=\"btn btn-primary mt-2\">Отправить</button>\r\n            </form>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default CommentForm;\r\n"]},"metadata":{},"sourceType":"module"}