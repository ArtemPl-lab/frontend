{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\User\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\learning\\\\vseotzivu\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _toConsumableArray from\"C:\\\\Users\\\\User\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\learning\\\\vseotzivu\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:\\\\Users\\\\User\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\learning\\\\vseotzivu\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:\\\\Users\\\\User\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\learning\\\\vseotzivu\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\User\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\learning\\\\vseotzivu\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useAPI}from'../../hooks/api.hook';import Card from'./Card';import Spinner from'../Spinners/Spinner';var CommentCards=function CommentCards(_ref){var postId=_ref.postId;var _useAPI=useAPI(),loading=_useAPI.loading,error=_useAPI.error,request=_useAPI.request;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),comments=_useState2[0],setComments=_useState2[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,graf,use,isUsed,dfs;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return request('/api/posts/comments','POST',JSON.stringify({postId:postId}));case 2:response=_context.sent;graf=new Map(response.map(function(comm){return[comm._id,_objectSpread(_objectSpread({},comm),{},{used:false})];}));use=function use(id){return graf.set(id,_objectSpread(_objectSpread({},graf.get(id)),{},{used:true}));};isUsed=function isUsed(id){return graf.get(id).used;};dfs=function dfs(id){use(id);return/*#__PURE__*/React.createElement(\"div\",{className:\"pl-3\",key:id},/*#__PURE__*/React.createElement(Card,{comment:graf.get(id)}),graf.get(id).replays.map(function(child){return!isUsed(child)?dfs(child):'';}));};setComments(_toConsumableArray(graf).map(function(v){return dfs(v[1]._id);}));case 8:case\"end\":return _context.stop();}}},_callee);})),[postId]);if(loading)return/*#__PURE__*/React.createElement(Spinner,null);return/*#__PURE__*/React.createElement(\"div\",{className:\"card mt-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\",style:{paddingLeft:0}},comments));};export default CommentCards;","map":{"version":3,"sources":["C:/Users/User/OneDrive/Рабочий стол/learning/vseotzivu/frontend/src/components/PostPage/CommentCards.jsx"],"names":["React","useEffect","useState","useAPI","Card","Spinner","CommentCards","postId","loading","error","request","comments","setComments","JSON","stringify","response","graf","Map","map","comm","_id","used","use","id","set","get","isUsed","dfs","replays","child","v","paddingLeft"],"mappings":"iuCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,MAAT,KAAuB,sBAAvB,CACA,MAAOC,CAAAA,IAAP,KAAiB,QAAjB,CACA,MAAOC,CAAAA,OAAP,KAAoB,qBAApB,CAEA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAAgB,IAAbC,CAAAA,MAAa,MAAbA,MAAa,aACIJ,MAAM,EADV,CACzBK,OADyB,SACzBA,OADyB,CAChBC,KADgB,SAChBA,KADgB,CACRC,OADQ,SACRA,OADQ,eAECR,QAAQ,CAAC,EAAD,CAFT,wCAEzBS,QAFyB,eAEfC,WAFe,eAIjCX,SAAS,sEAAC,0LACiBS,CAAAA,OAAO,CAAC,qBAAD,CAAwB,MAAxB,CAAgCG,IAAI,CAACC,SAAL,CAAe,CAAEP,MAAM,CAANA,MAAF,CAAf,CAAhC,CADxB,QACAQ,QADA,eAEFC,IAFE,CAEK,GAAIC,CAAAA,GAAJ,CAAQF,QAAQ,CAACG,GAAT,CAAa,SAAAC,IAAI,QAAI,CAACA,IAAI,CAACC,GAAN,gCAAeD,IAAf,MAAqBE,IAAI,CAAE,KAA3B,GAAJ,EAAjB,CAAR,CAFL,CAGAC,GAHA,CAGM,QAANA,CAAAA,GAAM,CAAAC,EAAE,QAAIP,CAAAA,IAAI,CAACQ,GAAL,CAASD,EAAT,gCAAiBP,IAAI,CAACS,GAAL,CAASF,EAAT,CAAjB,MAA+BF,IAAI,CAAE,IAArC,GAAJ,EAHR,CAIAK,MAJA,CAIS,QAATA,CAAAA,MAAS,CAAAH,EAAE,QAAIP,CAAAA,IAAI,CAACS,GAAL,CAASF,EAAT,EAAaF,IAAjB,EAJX,CAKAM,GALA,CAKM,QAANA,CAAAA,GAAM,CAAAJ,EAAE,CAAI,CACdD,GAAG,CAACC,EAAD,CAAH,CACA,mBACI,2BAAK,SAAS,CAAC,MAAf,CAAsB,GAAG,CAAEA,EAA3B,eACI,oBAAC,IAAD,EAAM,OAAO,CAAEP,IAAI,CAACS,GAAL,CAASF,EAAT,CAAf,EADJ,CAEKP,IAAI,CAACS,GAAL,CAASF,EAAT,EAAaK,OAAb,CAAqBV,GAArB,CAAyB,SAAAW,KAAK,QAAK,CAACH,MAAM,CAACG,KAAD,CAAR,CAAmBF,GAAG,CAACE,KAAD,CAAtB,CAAgC,EAApC,EAA9B,CAFL,CADJ,CAMH,CAbK,CAcNjB,WAAW,CAAC,mBAAII,IAAJ,EAAUE,GAAV,CAAc,SAAAY,CAAC,QAAIH,CAAAA,GAAG,CAACG,CAAC,CAAC,CAAD,CAAD,CAAKV,GAAN,CAAP,EAAf,CAAD,CAAX,CAdM,sDAAD,GAeN,CAAEb,MAAF,CAfM,CAAT,CAgBA,GAAGC,OAAH,CAAY,mBAAO,oBAAC,OAAD,MAAP,CACZ,mBACI,2BAAK,SAAS,CAAC,WAAf,eACI,2BAAK,SAAS,CAAC,WAAf,CAA2B,KAAK,CAAE,CAACuB,WAAW,CAAE,CAAd,CAAlC,EACKpB,QADL,CADJ,CADJ,CAOH,CA5BD,CA8BA,cAAeL,CAAAA,YAAf","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { useAPI } from '../../hooks/api.hook';\r\nimport Card from './Card';\r\nimport Spinner from '../Spinners/Spinner';\r\n\r\nconst CommentCards = ({ postId }) => {\r\n    const { loading, error,  request } = useAPI();\r\n    const [ comments, setComments ] = useState('');\r\n\r\n    useEffect(async ()=>{\r\n        const response = await request('/api/posts/comments', 'POST', JSON.stringify({ postId }));\r\n        let graf = new Map(response.map(comm => [comm._id, {...comm, used: false}]));\r\n        const use = id => graf.set(id, {...graf.get(id), used: true});\r\n        const isUsed = id => graf.get(id).used;\r\n        const dfs = id => {\r\n            use(id);\r\n            return(\r\n                <div className=\"pl-3\" key={id}>\r\n                    <Card comment={graf.get(id)}/>\r\n                    {graf.get(id).replays.map(child => (!isUsed(child)) ? dfs(child) : '')}\r\n                </div>\r\n            );\r\n        }\r\n        setComments([...graf].map(v => dfs(v[1]._id)));\r\n    }, [ postId ]);\r\n    if(loading) return <Spinner />\r\n    return (\r\n        <div className=\"card mt-4\">\r\n            <div className=\"card-body\" style={{paddingLeft: 0}}>\r\n                {comments}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default CommentCards;\r\n"]},"metadata":{},"sourceType":"module"}